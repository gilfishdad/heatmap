import numpy as np
import pandas as pd

# Creating a DataFrame with 10000 rows and 1000 columns
# with random floats between 0 and 10
data = np.random.uniform(0, 10, (30000, 1500))
df = pd.DataFrame(data)

df.head()  # Displaying the first few rows of the DataFrame





#coderuns_no issue with
#ColumnDataSource and also Hover functions

from bokeh.plotting import figure, show
from bokeh.models import ColumnDataSource, ColorBar, HoverTool
from bokeh.transform import linear_cmap
from bokeh.palettes import Viridis256 as palette
from bokeh.io import output_notebook

output_notebook()  # To display the plot in your Jupyter notebook

# Select a subset of the data
subset = df.iloc[200:550,200 :550]

# Prepare the data for ColumnDataSource|
colors = subset.values.flatten()
rows, cols = subset.shape
x = [i for i in range(cols) for _ in range(rows)]
y = [i for _ in range(cols) for i in range(rows)]

# Create a ColumnDataSource
data = {'x': x, 'y': y, 'colors': colors}
source = ColumnDataSource(data)

# Create a figure
p = figure(plot_width=800, plot_height=800, x_range=(-1, cols), y_range=(-1, rows),
           toolbar_location=None, tools="", title="Heatmap")

# Map colors
mapper = linear_cmap(field_name='colors', palette=palette, low=min(colors), high=max(colors))

# Create rectangles for heatmap
p.rect(x="x", y="y", width=1, height=1, source=source,
       line_color=None, fill_color=mapper)

# Add color bar
color_bar = ColorBar(color_mapper=mapper['transform'], width=8, location=(0,0))
p.add_layout(color_bar, 'right')

# Add hover tool
hover = HoverTool()
hover.tooltips = [
    ("Row", "@y"),
    ("Column", "@x"),
    ("Value", "@colors")
]
p.add_tools(hover)

show(p)
